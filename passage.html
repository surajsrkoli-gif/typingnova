<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Passage Typing Practice | Typing Nova</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Variables - Professional Compact */
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #3b82f6;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
            --dark-bg: #0f172a;
            --dark-surface: #1e293b;
            --dark-card: #2d3748;
            --text: #f7fafc;
            --text-light: #cbd5e0;
            --text-muted: #a0aec0;
            --border: #4a5568;
            --white: #ffffff;
            --shadow: rgba(0, 0, 0, 0.2);
            --shadow-hover: rgba(0, 0, 0, 0.3);
            --correct-bg: rgba(16, 185, 129, 0.1);
            --incorrect-bg: rgba(239, 68, 68, 0.1);
            --current-bg: rgba(37, 99, 235, 0.15);
            --timer-red: #dc2626;
            --timer-yellow: #d97706;
            --timer-green: #059669;
            --overlay-bg: rgba(15, 23, 42, 0.9);
        }

        /* Base Styles */
        body {
            font-family: 'Inter', sans-serif;
            color: var(--text);
            background-color: var(--dark-bg);
            line-height: 1.5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            font-size: 14px;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 15px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 6px 16px;
            border-radius: 4px;
            font-weight: 500;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.15s ease;
            border: none;
            font-family: 'Inter', sans-serif;
            gap: 5px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 3px 8px var(--shadow);
        }

        .btn-secondary {
            background-color: var(--dark-card);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background-color: var(--dark-surface);
            transform: translateY(-1px);
        }

        .btn-danger {
            background-color: var(--error);
            color: var(--white);
        }

        .btn-danger:hover {
            background-color: #dc2626;
            transform: translateY(-1px);
        }

        /* Header - Compact */
        header {
            padding: 10px 0;
            background-color: var(--dark-surface);
            border-bottom: 1px solid var(--border);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 18px;
            font-weight: 600;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .logo span {
            color: var(--primary);
        }

        .nav-links {
            display: flex;
            gap: 12px;
        }

        .nav-links a {
            color: var(--text-light);
            font-weight: 500;
            font-size: 13px;
            transition: color 0.15s;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        /* Status Bar - Compact */
        .status-bar {
            position: sticky;
            top: 0;
            background-color: var(--dark-surface);
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
            z-index: 100;
            box-shadow: 0 1px 4px var(--shadow);
        }

        .status-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-left, .status-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .status-item {
            display: flex;
            flex-direction: column;
        }

        .status-label {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 1px;
            text-transform: uppercase;
            letter-spacing: 0.4px;
        }

        .status-value {
            font-size: 18px;
            font-weight: 600;
        }

        .time-remaining {
            color: var(--timer-green);
            font-family: 'Courier New', monospace;
            font-weight: 700;
            font-size: 20px;
        }

        .gross-wpm {
            color: var(--primary);
        }

        .errors-count {
            color: var(--error);
        }

        .accuracy-percent {
            color: var(--success);
        }

        /* Main Content - Compact */
        main {
            flex: 1;
            padding: 15px 0;
        }

        .page-title {
            text-align: center;
            margin-bottom: 15px;
        }

        .page-title h1 {
            font-size: 20px;
            margin-bottom: 6px;
            color: var(--text);
            font-weight: 600;
        }

        .page-title p {
            color: var(--text-light);
            font-size: 13px;
            max-width: 550px;
            margin: 0 auto;
        }

        /* Two Column Layout - Compact */
        .typing-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            height: 55vh;
            min-height: 450px;
            margin-bottom: 15px;
        }

        .passage-column, .typing-column {
            display: flex;
            flex-direction: column;
            background-color: var(--dark-surface);
            border-radius: 6px;
            border: 1px solid var(--border);
            overflow: hidden;
            box-shadow: 0 2px 6px var(--shadow);
        }

        .column-header {
            padding: 10px 15px;
            background-color: var(--dark-card);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .column-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text);
        }

        .column-info {
            display: flex;
            gap: 12px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .info-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.4px;
        }

        .info-value {
            font-size: 13px;
            font-weight: 600;
        }

        /* Passage Display - Left */
        .passage-content {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            font-size: 15px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text);
            background-color: var(--dark-surface);
            font-family: 'Inter', sans-serif;
        }

        /* Character styling */
        .char {
            padding: 1px 0;
            border-radius: 2px;
            transition: all 0.1s;
            position: relative;
        }

        .char.correct {
            background-color: var(--correct-bg);
            color: var(--success);
        }

        .char.incorrect {
            background-color: var(--incorrect-bg);
            color: var(--error);
            text-decoration: line-through;
        }

        .char.current {
            background-color: var(--current-bg);
            border-bottom: 2px solid var(--primary);
            animation: pulse 1.5s infinite;
        }

        .char.current::after {
            content: '|';
            position: absolute;
            right: -2px;
            color: var(--primary);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        @keyframes pulse {
            0% { background-color: var(--current-bg); }
            50% { background-color: rgba(37, 99, 235, 0.25); }
            100% { background-color: var(--current-bg); }
        }

        /* Typing Input - Right */
        .typing-area {
            flex: 1;
            width: 100%;
            padding: 15px;
            background-color: var(--dark-card);
            color: var(--text);
            border: none;
            resize: none;
            font-size: 15px;
            line-height: 1.6;
            font-family: 'Inter', sans-serif;
            overflow-y: auto;
            outline: none;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .typing-area:focus {
            outline: none;
            box-shadow: inset 0 0 0 1px var(--primary);
        }

        .typing-area.disabled {
            background-color: var(--dark-surface);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .typing-area::placeholder {
            color: var(--text-muted);
            font-style: italic;
        }

        /* Tab Start Overlay */
        .tab-start-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--overlay-bg);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .tab-start-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .tab-start-card {
            background-color: var(--dark-surface);
            border-radius: 8px;
            padding: 25px;
            border: 1px solid var(--border);
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }

        .tab-start-icon {
            font-size: 40px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .tab-start-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text);
        }

        .tab-start-message {
            color: var(--text-light);
            font-size: 14px;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .tab-key {
            display: inline-block;
            background: linear-gradient(135deg, var(--dark-card), var(--dark-surface));
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 4px;
            border: 2px solid var(--primary);
            font-size: 16px;
            font-weight: 600;
            margin: 10px 0;
            box-shadow: 0 4px 8px rgba(37, 99, 235, 0.2);
        }

        /* Instructions - Compact */
        .instructions {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin: 12px 0;
            padding: 10px;
            background-color: var(--dark-surface);
            border-radius: 4px;
            border: 1px solid var(--border);
            font-size: 12px;
        }

        .instruction-item {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-light);
        }

        .instruction-item i {
            font-size: 11px;
        }

        .instruction-item .key {
            background-color: var(--dark-card);
            padding: 2px 6px;
            border-radius: 3px;
            border: 1px solid var(--border);
            font-family: monospace;
            font-size: 11px;
            margin: 0 3px;
        }

        /* Control Buttons - Compact */
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
        }

        /* Results Section - Compact */
        .results-container {
            display: none;
            margin: 20px 0;
            background-color: var(--dark-surface);
            border-radius: 6px;
            padding: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 3px 8px var(--shadow);
        }

        .results-container.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .results-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .results-header h2 {
            font-size: 18px;
            margin-bottom: 6px;
            color: var(--text);
            font-weight: 600;
        }

        .results-header p {
            color: var(--text-light);
            font-size: 13px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .result-card {
            text-align: center;
            padding: 15px 10px;
            background-color: var(--dark-card);
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        .result-value {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .result-label {
            font-size: 12px;
            color: var(--text-muted);
        }

        .result-gross {
            border-top: 2px solid var(--primary);
        }

        .result-net {
            border-top: 2px solid var(--success);
        }

        .result-errors {
            border-top: 2px solid var(--error);
        }

        .result-accuracy {
            border-top: 2px solid var(--secondary);
        }

        .result-chars {
            border-top: 2px solid #9333ea;
        }

        .results-actions {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        /* Footer - Compact */
        footer {
            background-color: #0f172a;
            color: #f1f5f9;
            padding: 20px 0 15px;
            border-top: 1px solid var(--border);
            margin-top: auto;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.2rem;
        }

        .footer-logo {
            font-size: 16px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 0.6rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .footer-logo span {
            color: var(--primary);
        }

        .footer-about {
            font-size: 12px;
            color: var(--text-light);
            line-height: 1.5;
        }

        .footer-heading {
            font-size: 14px;
            margin-bottom: 0.8rem;
            color: var(--white);
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-links a {
            color: var(--text-light);
            transition: color 0.15s;
            font-size: 12px;
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        .copyright {
            text-align: center;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-muted);
            font-size: 11px;
        }

        /* Responsive Styles */
        @media (max-width: 1200px) {
            .typing-container {
                height: 50vh;
                min-height: 400px;
            }
            
            .container {
                max-width: 1200px;
            }
        }

        @media (max-width: 992px) {
            .typing-container {
                grid-template-columns: 1fr;
                height: auto;
                min-height: 700px;
            }
            
            .passage-column, .typing-column {
                height: 350px;
            }
            
            .status-content {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }
            
            .status-left, .status-right {
                width: 100%;
                justify-content: space-between;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 8px;
            }
            
            .nav-links {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .status-left, .status-right {
                flex-wrap: wrap;
                gap: 8px;
            }
            
            .status-item {
                min-width: 70px;
            }
            
            .page-title h1 {
                font-size: 18px;
            }
            
            .column-header {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }
            
            .column-info {
                width: 100%;
                justify-content: space-between;
            }
            
            .results-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .controls, .results-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 250px;
            }
            
            .typing-container {
                min-height: 600px;
            }
        }

        @media (max-width: 576px) {
            .passage-column, .typing-column {
                height: 300px;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .page-title h1 {
                font-size: 16px;
            }
            
            .passage-content, .typing-area {
                font-size: 14px;
                line-height: 1.5;
                padding: 12px;
            }
            
            .status-value {
                font-size: 16px;
            }
            
            .time-remaining {
                font-size: 18px;
            }
            
            .typing-container {
                min-height: 550px;
            }
            
            .tab-start-card {
                padding: 20px;
                margin: 15px;
            }
            
            .tab-start-title {
                font-size: 18px;
            }
            
            .tab-start-message {
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-content">
            <a href="index.html" class="logo">
                <i class="fas fa-keyboard"></i>
                Typing<span>Nova</span>
            </a>
            <nav class="nav-links">
                <a href="index.html">Home</a>
                <a href="speed-test.html">Speed Test</a>
                <a href="passage-typing.html" class="active">Passage Typing</a>
                <a href="about.html">About</a>
            </nav>
        </div>
    </header>

    <!-- Top Status Bar -->
    <div class="status-bar">
        <div class="container status-content">
            <div class="status-left">
                <div class="status-item">
                    <div class="status-label">Time Remaining</div>
                    <div class="status-value time-remaining" id="timeRemaining">07:00</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Current Position</div>
                    <div class="status-value" id="currentPosition">0 / 0</div>
                </div>
            </div>
            <div class="status-right">
                <div class="status-item">
                    <div class="status-label">Gross WPM</div>
                    <div class="status-value gross-wpm" id="grossWPM">0</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Errors</div>
                    <div class="status-value errors-count" id="errorsCount">0</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Accuracy</div>
                    <div class="status-value accuracy-percent" id="accuracyPercent">100%</div>
                </div>
                <button class="btn btn-danger" id="resetButton">
                    <i class="fas fa-redo"></i>
                    Reset
                </button>
            </div>
        </div>
    </div>

    <!-- Tab Start Overlay -->
    <div class="tab-start-overlay" id="tabStartOverlay">
        <div class="tab-start-card">
            <div class="tab-start-icon">
                <i class="fas fa-keyboard"></i>
            </div>
            <h2 class="tab-start-title">Ready to Start Typing</h2>
            <p class="tab-start-message">
                Press the <span class="tab-key">TAB</span> key to begin the 7-minute typing test.
                <br>
                The timer will start immediately when you press Tab.
            </p>
            <div class="instructions" style="background: transparent; border: none; margin: 15px 0;">
                <div class="instruction-item">
                    <i class="fas fa-clock" style="color: var(--success);"></i>
                    <span>7-minute timed practice</span>
                </div>
                <div class="instruction-item">
                    <i class="fas fa-sync-alt" style="color: var(--primary);"></i>
                    <span>New passage each time</span>
                </div>
            </div>
            <button class="btn btn-secondary" id="closeTabOverlay" style="margin-top: 10px;">
                <i class="fas fa-times"></i>
                Close Instructions
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main>
        <div class="container">
            <!-- Page Title -->
            <div class="page-title">
                <h1>7-Minute Passage Typing Practice</h1>
                <p>Press <span style="color: var(--primary); font-weight: 600;">TAB</span> to start typing. Passage on left, typing area on right.</p>
            </div>

            <!-- Instructions -->
            <div class="instructions">
                <div class="instruction-item">
                    <i class="fas fa-info-circle" style="color: var(--primary);"></i>
                    <span>Press <span class="key">TAB</span> to start typing test</span>
                </div>
                <div class="instruction-item">
                    <i class="fas fa-exclamation-triangle" style="color: var(--error);"></i>
                    <span>Errors counted even if corrected</span>
                </div>
                <div class="instruction-item">
                    <i class="fas fa-clock" style="color: var(--success);"></i>
                    <span>7-minute timer starts on first key</span>
                </div>
                <div class="instruction-item">
                    <i class="fas fa-sync-alt" style="color: var(--secondary);"></i>
                    <span>New passage each practice</span>
                </div>
            </div>

            <!-- Two Column Layout -->
            <div class="typing-container">
                <!-- Left Column: Passage Display -->
                <div class="passage-column">
                    <div class="column-header">
                        <div class="column-title">Passage to Type</div>
                        <div class="column-info">
                            <div class="info-item">
                                <div class="info-label">Words</div>
                                <div class="info-value" id="totalWords">0</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Chars</div>
                                <div class="info-value" id="totalChars">0</div>
                            </div>
                        </div>
                    </div>
                    <div class="passage-content" id="passageDisplay">
                        Loading passage...
                    </div>
                </div>

                <!-- Right Column: Typing Area -->
                <div class="typing-column">
                    <div class="column-header">
                        <div class="column-title">Your Typing</div>
                        <div class="column-info">
                            <div class="info-item">
                                <div class="info-label">Progress</div>
                                <div class="info-value" id="progressPercent">0%</div>
                            </div>
                            <button class="btn btn-secondary btn-small" id="focusTypingBtn">
                                <i class="fas fa-mouse-pointer"></i>
                                Focus
                            </button>
                        </div>
                    </div>
                    <textarea 
                        class="typing-area" 
                        id="typingInput" 
                        placeholder="Press TAB to start typing. Type the passage exactly as shown on the left."
                        spellcheck="false"
                        autocomplete="off"
                        autocorrect="off"
                        autocapitalize="off"
                    ></textarea>
                </div>
            </div>

            <!-- Control Buttons -->
            <div class="controls">
                <button class="btn btn-primary" id="startButton">
                    <i class="fas fa-play"></i>
                    Start Practice
                </button>
                <button class="btn btn-secondary" id="newPassageButton">
                    <i class="fas fa-sync-alt"></i>
                    New Passage
                </button>
                <button class="btn btn-secondary" id="pauseButton" style="display: none;">
                    <i class="fas fa-pause"></i>
                    Pause
                </button>
            </div>

            <!-- Results Section -->
            <div class="results-container" id="resultsContainer">
                <div class="results-header">
                    <h2>Typing Practice Results</h2>
                    <p>Your 7-minute typing practice results</p>
                </div>
                <div class="results-grid">
                    <div class="result-card result-gross">
                        <div class="result-value" id="resultGrossWPM">0</div>
                        <div class="result-label">Gross Speed (WPM)</div>
                    </div>
                    <div class="result-card result-net">
                        <div class="result-value" id="resultNetWPM">0</div>
                        <div class="result-label">Net Speed (WPM)</div>
                    </div>
                    <div class="result-card result-errors">
                        <div class="result-value" id="resultErrors">0</div>
                        <div class="result-label">Total Errors</div>
                    </div>
                    <div class="result-card result-accuracy">
                        <div class="result-value" id="resultAccuracy">100%</div>
                        <div class="result-label">Accuracy</div>
                    </div>
                    <div class="result-card result-chars">
                        <div class="result-value" id="resultChars">0</div>
                        <div class="result-label">Characters Typed</div>
                    </div>
                </div>
                <div class="results-actions">
                    <button class="btn btn-primary" id="practiceAgainButton">
                        <i class="fas fa-redo"></i>
                        Practice Again
                    </button>
                    <button class="btn btn-secondary" id="newPracticeButton">
                        <i class="fas fa-sync-alt"></i>
                        New Passage
                    </button>
                </div>
            </div>

            <!-- AdSense Safe Area -->
            <div class="ad-container" style="margin: 20px 0; text-align: center; color: var(--text-muted); font-size: 12px; padding: 12px; background-color: var(--dark-surface); border-radius: 4px; border: 1px dashed var(--border);">
                <p>Advertisement Area</p>
                <p style="margin-top: 6px; font-size: 11px;">This area is designed for AdSense ads. It appears only after completing a practice session.</p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-about-section">
                    <div class="footer-logo">
                        <i class="fas fa-keyboard"></i>
                        Typing<span>Nova</span>
                    </div>
                    <p class="footer-about">Typing Nova provides a professional environment for practicing typing speed and accuracy through timed tests and passage typing.</p>
                </div>
                <div>
                    <h3 class="footer-heading">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="speed-test.html">Speed Test</a></li>
                        <li><a href="passage-typing.html">Passage Typing</a></li>
                        <li><a href="about.html">About</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="footer-heading">Legal</h3>
                    <ul class="footer-links">
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="terms.html">Terms & Conditions</a></li>
                        <li><a href="cookies.html">Cookie Policy</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                © <span id="currentYear"></span> Typing Nova – All rights reserved
            </div>
        </div>
    </footer>

    <!-- Font Awesome Icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

    <script>
        // Typing Practice Application with Tab Start Feature
        class PassageTypingPractice {
            constructor() {
                // DOM Elements
                this.passageDisplay = document.getElementById('passageDisplay');
                this.typingInput = document.getElementById('typingInput');
                this.timeRemaining = document.getElementById('timeRemaining');
                this.grossWPM = document.getElementById('grossWPM');
                this.errorsCount = document.getElementById('errorsCount');
                this.accuracyPercent = document.getElementById('accuracyPercent');
                this.totalChars = document.getElementById('totalChars');
                this.totalWords = document.getElementById('totalWords');
                this.currentPosition = document.getElementById('currentPosition');
                this.progressPercent = document.getElementById('progressPercent');
                this.resetButton = document.getElementById('resetButton');
                this.startButton = document.getElementById('startButton');
                this.newPassageButton = document.getElementById('newPassageButton');
                this.pauseButton = document.getElementById('pauseButton');
                this.focusTypingBtn = document.getElementById('focusTypingBtn');
                this.resultsContainer = document.getElementById('resultsContainer');
                this.resultGrossWPM = document.getElementById('resultGrossWPM');
                this.resultNetWPM = document.getElementById('resultNetWPM');
                this.resultErrors = document.getElementById('resultErrors');
                this.resultAccuracy = document.getElementById('resultAccuracy');
                this.resultChars = document.getElementById('resultChars');
                this.practiceAgainButton = document.getElementById('practiceAgainButton');
                this.newPracticeButton = document.getElementById('newPracticeButton');
                this.tabStartOverlay = document.getElementById('tabStartOverlay');
                this.closeTabOverlay = document.getElementById('closeTabOverlay');
                
                // State variables
                this.originalPassage = '';
                this.passageChars = [];
                this.currentPassageIndex = 0;
                this.errors = 0;
                this.startTime = null;
                this.endTime = null;
                this.timerInterval = null;
                this.totalTime = 7 * 60; // 7 minutes in seconds
                this.timeLeft = this.totalTime;
                this.isRunning = false;
                this.isCompleted = false;
                this.isPaused = false;
                this.totalTypedChars = 0;
                this.correctChars = 0;
                this.errorMap = new Map();
                this.hasStarted = false;
                this.showTabOverlay = true;
                
                // Passages database - 7 MINUTE PASSAGES (~350 words each)
                this.passages = [
                    `Digital technology has transformed modern communication, work, and information access. This revolution offers unprecedented convenience while presenting complex challenges that require thoughtful adaptation and navigation.

Internet connectivity has evolved from luxury to essential utility, enabling instant global communication and access to vast knowledge repositories. This network supports e-commerce, remote education, telemedicine, and digital governance, reshaping traditional systems and creating new opportunities.

Artificial intelligence and machine learning represent significant technological milestones, offering data analysis, pattern recognition, and automation capabilities previously unimaginable. These technologies power recommendation systems, language translation, and predictive analytics while raising important ethical and privacy questions.

The shift toward remote work, accelerated by recent developments, demonstrates distributed teams' viability and virtual collaboration. Video conferencing, cloud productivity tools, and digital project management enable organizational operations while offering employees greater work arrangement flexibility.

Environmental sustainability considerations gain prominence in technology discussions. Data center energy consumption, electronic waste management, and device manufacturing resource intensity require innovative solutions and responsible consumption patterns to minimize ecological impacts.

Digital literacy becomes essential for effective modern society participation. Navigating online platforms, evaluating digital information critically, protecting personal data, and utilizing technology productively represent fundamental competencies educational systems increasingly prioritize.

Virtual and augmented reality integration offers immersive educational, training, entertainment, and design applications. These technologies create simulated environments enhancing learning, facilitating remote collaboration, and providing innovative complex problem solutions.

Cybersecurity concerns grow alongside technological adoption, with digital infrastructure and personal information protection becoming increasingly important. Robust security measures, user awareness, and ethical data handling considerations represent responsible technology use essential components.

Information democratization through digital platforms empowers individuals and communities while challenging traditional media structures. Social networks, blogging platforms, and content sharing sites create new expression, organization, and information dissemination avenues.

Future technological developments will likely continue reshaping social, economic, and cultural landscapes. Emerging fields like quantum computing, biotechnology-digital system integration, and advanced robotics promise further transformation while demanding careful societal implication and ethical dimension consideration.`,

                    `Effective communication represents fundamental human capacity enabling idea, information, and emotion exchange across diverse contexts and cultures. This complex process involves verbal expression, nonverbal cues, listening skills, and contextual understanding facilitating meaningful interaction.

Language development begins early childhood and continues throughout lifespan, reflecting biological predisposition and environmental influence. Vocabulary acquisition, grammatical structures, and pragmatic skills enable increasingly sophisticated expression and comprehension, forming cognitive development and social integration foundation.

Written communication evolved through various mediums from stone carvings and parchment to digital text, each format influencing idea structuring, preservation, and dissemination. Digital writing transition introduced new conventions while maintaining clarity, coherence, and audience consideration core principles.

Professional organizational communication requires specific skills including formal report writing, presentation delivery, meeting facilitation, and digital correspondence. These competencies support coordination, decision-making, and relationship building within and between various sector and industry organizations.

Intercultural communication addresses cross-cultural boundary message exchange challenges and opportunities. Understanding communication style, nonverbal behavior, and contextual expectation cultural variations enhances global interaction effectiveness and reduces diverse setting misunderstandings.

Nonverbal communication encompasses facial expressions, gestures, posture, eye contact, and vocal qualities complementing or sometimes contradicting verbal messages. These cues provide additional meaning layers and emotional context, often operating subconscious levels while significantly influencing interpersonal dynamics.

Listening represents active process involving attention, interpretation, and response going beyond merely hearing words. Effective listening requires concentration, empathy, and judgment suspension to fully comprehend messages and demonstrate speaker respect.

Digital communication tools including email, instant messaging, and video conferencing created new interaction channels with distinct conventions and expectations. These platforms offer efficiency and accessibility while sometimes lacking face-to-face communication richness and requiring optimal use adapted skills.

Persuasive communication involves crafting messages influencing attitudes, beliefs, or behaviors through logical argument, emotional appeal, and credibility establishment. This skill finds marketing, leadership, advocacy, and everyday situation application where influencing outcomes proves desirable.

Communication barriers including language differences, cultural misunderstandings, emotional interference, and technological limitations impede effective message exchange. Identifying and addressing these barriers through clarification, adaptation, and patience enhances various context communication effectiveness.

Communication future will likely involve continued technological innovation, evolving social norms, and perhaps new expression forms yet developed. Maintaining clarity, empathy, and ethical consideration core principles while adapting changing circumstances remains essential meaningful human connection.`,

                    `Critical thinking represents disciplined process actively analyzing, evaluating, and synthesizing information forming reasoned judgments and making informed decisions. This cognitive skill set enables complex information environment navigation, effective problem solving, and intellectual rigor and objectivity challenge approach.

Critical thinking foundation involves recognizing explicit and implicit assumptions underlying arguments, beliefs, and information presentations. Identifying these foundational elements allows thorough examination validity, relevance, and potential biases before accepting conclusions or making determinations.

Logical reasoning requires understanding deductive, inductive, and abductive argument types, each possessing distinct structures and evaluation standards. Recognizing circular reasoning or false dilemma logical fallacies helps maintain intellectual integrity and avoid flawed conclusions.

Evidence evaluation involves assessing claim or argument supporting information quality, relevance, and sufficiency. This process considers source credibility, methodological soundness, contextual factors, and potential limitations while weighing contradictory evidence appropriately.

Problem-solving methodologies typically involve clearly defining problems, generating potential solutions, systematically evaluating alternatives, implementing chosen approaches, and assessing outcomes. This structured approach increases effective resolution likelihood while providing learning and refinement opportunities.

Decision-making processes benefit from critical thinking through thorough option, consequence, priority, and uncertainty consideration. Balancing quantitative data with qualitative factors, short-term implications with long-term effects, and individual preferences with broader impacts leads more robust and defensible choices.

Metacognition, or thinking about personal thinking, enhances critical thinking encouraging cognitive process, bias, and limitation self-awareness. Regular reasoning approach, assumption, and potential improvement reflection develops more sophisticated thinking skills over time.

Creative thinking complements critical thinking generating novel ideas, perspectives, and solutions possibly not emerging through purely analytical approaches. Divergent and convergent thinking process integration fosters innovation while maintaining evaluative rigor.

Digital environment information literacy requires locating, evaluating, and effectively using information skills amid vast available data quantities. Distinguishing credible from questionable sources, recognizing misinformation patterns, and verifying claims through multiple channels represent essential contemporary competencies.

Ethical considerations permeate critical thinking processes requiring fairness, honesty, intellectual humility, and diverse perspective respect attention. Acknowledging personal knowledge limitations, remaining open reconsideration, and respectfully engaging differing viewpoints strengthens reasoning quality.

Critical thinking skill development educational approaches typically involve explicit instruction, modeling, feedback practice, and various discipline real-world application. These methods help internalize academic setting beyond transferring professional and personal context thinking habits.

Critical thinking ongoing development represents lifelong endeavor possessing personal, professional, and societal benefits. As information environments become increasingly complex and challenges more interconnected, these cognitive skills grow importance individual agency and collective wellbeing.`
                ];
                
                // Initialize the application
                this.init();
            }
            
            init() {
                // Set current year in footer
                document.getElementById('currentYear').textContent = new Date().getFullYear();
                
                // Load initial passage
                this.loadRandomPassage();
                
                // Event listeners
                this.typingInput.addEventListener('input', this.handleTyping.bind(this));
                this.typingInput.addEventListener('keydown', this.handleKeyDown.bind(this));
                this.typingInput.addEventListener('paste', (e) => e.preventDefault());
                this.typingInput.addEventListener('copy', (e) => e.preventDefault());
                this.typingInput.addEventListener('cut', (e) => e.preventDefault());
                
                // Global Tab key listener for starting test
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Tab') {
                        e.preventDefault();
                        
                        // If overlay is visible, close it and start
                        if (this.tabStartOverlay.classList.contains('active') && !this.isRunning) {
                            this.closeTabOverlay.click();
                            this.startWithTab();
                        } 
                        // If already started, switch focus
                        else if (this.isRunning && !this.isPaused) {
                            if (document.activeElement === this.typingInput) {
                                this.passageDisplay.focus();
                            } else {
                                this.typingInput.focus();
                            }
                        }
                        // If not started yet, start with Tab
                        else if (!this.isRunning && !this.hasStarted) {
                            this.startWithTab();
                        }
                    }
                });
                
                this.startButton.addEventListener('click', this.startPractice.bind(this));
                this.resetButton.addEventListener('click', this.resetPractice.bind(this));
                this.newPassageButton.addEventListener('click', () => this.loadRandomPassage());
                this.pauseButton.addEventListener('click', this.togglePause.bind(this));
                this.focusTypingBtn.addEventListener('click', () => {
                    this.typingInput.focus();
                    if (!this.isRunning && !this.hasStarted) {
                        this.startWithTab();
                    }
                });
                this.practiceAgainButton.addEventListener('click', this.resetPractice.bind(this));
                this.newPracticeButton.addEventListener('click', () => {
                    this.loadRandomPassage();
                    this.resetPractice();
                });
                this.closeTabOverlay.addEventListener('click', () => {
                    this.tabStartOverlay.classList.remove('active');
                    this.showTabOverlay = false;
                    this.typingInput.focus();
                });
                
                // Show tab overlay on first load
                setTimeout(() => {
                    if (this.showTabOverlay) {
                        this.tabStartOverlay.classList.add('active');
                    }
                }, 500);
                
                // Set initial state
                this.updateStatus();
                this.updatePassageDisplay();
            }
            
            loadRandomPassage() {
                // Select a random passage (every time new passage)
                const randomIndex = Math.floor(Math.random() * this.passages.length);
                this.originalPassage = this.passages[randomIndex];
                this.passageChars = this.originalPassage.split('');
                
                // Calculate words (approximate) - should be ~350 words
                const words = this.originalPassage.trim().split(/\s+/).length;
                
                // Update display
                this.totalChars.textContent = this.originalPassage.length;
                this.totalWords.textContent = words;
                this.currentPosition.textContent = `0 / ${this.originalPassage.length}`;
                this.progressPercent.textContent = '0%';
                
                // Reset typing state
                this.currentPassageIndex = 0;
                this.errors = 0;
                this.totalTypedChars = 0;
                this.correctChars = 0;
                this.errorMap.clear();
                this.hasStarted = false;
                
                this.updatePassageDisplay();
                this.updateStatus();
                
                // Clear typing input
                this.typingInput.value = '';
                this.typingInput.disabled = false;
                this.typingInput.classList.remove('disabled');
                
                // Hide results
                this.resultsContainer.classList.remove('active');
                
                // Reset timer to 7 minutes
                this.resetTimer();
                
                // Show tab overlay for new passage
                if (this.showTabOverlay) {
                    this.tabStartOverlay.classList.add('active');
                }
            }
            
            startWithTab() {
                if (!this.isRunning && !this.hasStarted) {
                    this.hasStarted = true;
                    this.typingInput.focus();
                    this.tabStartOverlay.classList.remove('active');
                    
                    // Show instruction that typing should start
                    const placeholder = "Start typing now. Timer will begin with your first keystroke.";
                    this.typingInput.placeholder = placeholder;
                }
            }
            
            startPractice() {
                if (!this.isRunning && !this.hasStarted) {
                    this.hasStarted = true;
                    this.typingInput.focus();
                    this.tabStartOverlay.classList.remove('active');
                    this.showTabOverlay = false;
                }
            }
            
            updatePassageDisplay() {
                let displayHTML = '';
                
                for (let i = 0; i < this.passageChars.length; i++) {
                    let charClass = '';
                    let charContent = this.passageChars[i];
                    
                    // Handle special characters for display
                    if (charContent === ' ') {
                        charContent = ' ';
                    } else if (charContent === '\n') {
                        charContent = '\n';
                    }
                    
                    if (i < this.currentPassageIndex) {
                        // Already typed characters
                        if (this.errorMap.has(i)) {
                            charClass = 'incorrect';
                        } else {
                            charClass = 'correct';
                        }
                    } else if (i === this.currentPassageIndex) {
                        // Current character
                        charClass = 'current';
                    }
                    
                    // Handle newlines specially
                    if (charContent === '\n') {
                        displayHTML += `<br><span class="char ${charClass}"> </span>`;
                    } else {
                        displayHTML += `<span class="char ${charClass}">${this.escapeHtml(charContent)}</span>`;
                    }
                }
                
                this.passageDisplay.innerHTML = displayHTML;
                
                // Scroll current character into view
                const currentChar = this.passageDisplay.querySelector('.char.current');
                if (currentChar) {
                    currentChar.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });
                }
            }
            
            escapeHtml(text) {
                const map = {
                    '&': '&amp;',
                    '<': '&lt;',
                    '>': '&gt;',
                    '"': '&quot;',
                    "'": '&#039;'
                };
                return text.replace(/[&<>"']/g, function(m) { return map[m]; });
            }
            
            handleTyping(e) {
                if (this.isCompleted || this.isPaused) return;
                
                const input = this.typingInput.value;
                const inputLength = input.length;
                
                // Start timer on first keystroke
                if (!this.isRunning && inputLength > 0) {
                    this.startTimer();
                }
                
                // Check if user is trying to type beyond current position
                if (inputLength > this.currentPassageIndex + 1) {
                    this.typingInput.value = input.substring(0, this.currentPassageIndex);
                    return;
                }
                
                // Handle backspace
                if (inputLength < this.currentPassageIndex) {
                    this.currentPassageIndex = inputLength;
                    this.updatePassageDisplay();
                    this.updateStatus();
                    return;
                }
                
                // Handle new character
                if (inputLength === this.currentPassageIndex + 1) {
                    const typedChar = input[this.currentPassageIndex];
                    const expectedChar = this.passageChars[this.currentPassageIndex];
                    
                    // Strict character comparison
                    let isCorrect = typedChar === expectedChar;
                    
                    // Special handling for Enter key
                    if (typedChar === '\n' && expectedChar !== '\n') {
                        isCorrect = false;
                    }
                    
                    // Update counts
                    this.totalTypedChars++;
                    
                    if (isCorrect) {
                        this.correctChars++;
                        if (this.errorMap.has(this.currentPassageIndex)) {
                            this.errorMap.delete(this.currentPassageIndex);
                        }
                    } else {
                        this.errors++;
                        this.errorMap.set(this.currentPassageIndex, {
                            typed: typedChar,
                            expected: expectedChar,
                            time: Date.now()
                        });
                    }
                    
                    this.currentPassageIndex++;
                    
                    // Update progress percentage
                    const progress = this.passageChars.length > 0 ? 
                        Math.round((this.currentPassageIndex / this.passageChars.length) * 100) : 0;
                    this.progressPercent.textContent = `${progress}%`;
                    
                    // Check if passage is completed
                    if (this.currentPassageIndex >= this.passageChars.length) {
                        this.completePractice();
                    }
                    
                    this.updatePassageDisplay();
                    this.updateStatus();
                }
            }
            
            handleKeyDown(e) {
                // Tab key handled globally
                if (e.key === 'Tab') {
                    e.preventDefault();
                    return;
                }
                
                // Handle Enter key - only allow at correct positions
                if (e.key === 'Enter') {
                    if (this.currentPassageIndex < this.passageChars.length) {
                        const expectedChar = this.passageChars[this.currentPassageIndex];
                        
                        if (expectedChar !== '\n') {
                            e.preventDefault();
                            // Add error for pressing Enter at wrong position
                            setTimeout(() => {
                                this.errors++;
                                this.errorMap.set(this.currentPassageIndex, {
                                    typed: '\n',
                                    expected: expectedChar,
                                    time: Date.now()
                                });
                                this.updateStatus();
                            }, 0);
                            return;
                        }
                    }
                }
                
                // Allow backspace, delete, arrow keys, etc.
                const allowedKeys = [
                    'Backspace', 'Delete', 'ArrowLeft', 'ArrowRight', 
                    'ArrowUp', 'ArrowDown', 'Home', 'End'
                ];
                
                if (allowedKeys.includes(e.key)) {
                    return;
                }
                
                // Prevent typing if practice is completed
                if (this.isCompleted || this.isPaused) {
                    e.preventDefault();
                    return;
                }
            }
            
            startTimer() {
                if (this.isRunning) return;
                
                this.isRunning = true;
                this.hasStarted = true;
                this.startTime = Date.now();
                this.startButton.style.display = 'none';
                this.pauseButton.style.display = 'flex';
                
                this.timerInterval = setInterval(() => {
                    if (!this.isPaused) {
                        this.timeLeft--;
                        
                        if (this.timeLeft <= 0) {
                            this.timeLeft = 0;
                            this.completePractice();
                        }
                        
                        this.updateTimerDisplay();
                        this.updateStatus();
                    }
                }, 1000);
            }
            
            updateTimerDisplay() {
                const minutes = Math.floor(this.timeLeft / 60);
                const seconds = this.timeLeft % 60;
                
                // Change color based on remaining time
                let timeColor = 'var(--timer-green)';
                if (this.timeLeft < 60) {
                    timeColor = 'var(--timer-red)';
                } else if (this.timeLeft < 180) {
                    timeColor = 'var(--timer-yellow)';
                }
                
                this.timeRemaining.textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                this.timeRemaining.style.color = timeColor;
            }
            
            resetTimer() {
                clearInterval(this.timerInterval);
                this.isRunning = false;
                this.isPaused = false;
                this.hasStarted = false;
                this.timeLeft = this.totalTime;
                this.updateTimerDisplay();
                this.startButton.style.display = 'flex';
                this.pauseButton.style.display = 'none';
                this.pauseButton.innerHTML = '<i class="fas fa-pause"></i> Pause';
                this.timeRemaining.style.color = 'var(--timer-green)';
                
                // Reset placeholder
                this.typingInput.placeholder = "Press TAB to start typing. Type the passage exactly as shown on the left.";
            }
            
            togglePause() {
                if (!this.isRunning) return;
                
                this.isPaused = !this.isPaused;
                
                if (this.isPaused) {
                    this.pauseButton.innerHTML = '<i class="fas fa-play"></i> Resume';
                    this.typingInput.disabled = true;
                    this.typingInput.classList.add('disabled');
                } else {
                    this.pauseButton.innerHTML = '<i class="fas fa-pause"></i> Pause';
                    this.typingInput.disabled = false;
                    this.typingInput.classList.remove('disabled');
                    this.typingInput.focus();
                }
            }
            
            updateStatus() {
                // Calculate elapsed time in minutes
                const elapsedMinutes = this.isRunning ? 
                    ((Date.now() - this.startTime) / 1000 / 60) : 0;
                
                // Calculate Gross WPM (1 word = 5 characters)
                const grossWPM = elapsedMinutes > 0 ? 
                    (this.totalTypedChars / 5) / elapsedMinutes : 0;
                
                // Calculate Net WPM
                const errorsPerMinute = elapsedMinutes > 0 ? this.errors / elapsedMinutes : 0;
                let netWPM = grossWPM - errorsPerMinute;
                netWPM = netWPM < 0 ? 0 : netWPM;
                
                // Calculate Accuracy
                const accuracy = this.totalTypedChars > 0 ? 
                    ((this.totalTypedChars - this.errors) / this.totalTypedChars) * 100 : 100;
                
                // Update status bar
                this.grossWPM.textContent = Math.round(grossWPM);
                this.errorsCount.textContent = this.errors;
                this.accuracyPercent.textContent = `${Math.min(100, Math.round(accuracy))}%`;
                this.currentPosition.textContent = `${this.currentPassageIndex} / ${this.passageChars.length}`;
            }
            
            completePractice() {
                clearInterval(this.timerInterval);
                this.isRunning = false;
                this.isCompleted = true;
                
                // Disable typing input
                this.typingInput.disabled = true;
                this.typingInput.classList.add('disabled');
                
                // Calculate final results
                const elapsedMinutes = this.startTime ? 
                    ((Date.now() - this.startTime) / 1000 / 60) : 0.01;
                
                // Final Gross WPM
                const finalGrossWPM = (this.totalTypedChars / 5) / elapsedMinutes;
                
                // Final Net WPM
                const errorsPerMinute = this.errors / elapsedMinutes;
                let finalNetWPM = finalGrossWPM - errorsPerMinute;
                finalNetWPM = finalNetWPM < 0 ? 0 : finalNetWPM;
                
                // Final Accuracy
                const finalAccuracy = this.totalTypedChars > 0 ? 
                    ((this.totalTypedChars - this.errors) / this.totalTypedChars) * 100 : 0;
                
                // Update results display
                this.resultGrossWPM.textContent = Math.round(finalGrossWPM);
                this.resultNetWPM.textContent = Math.round(finalNetWPM);
                this.resultErrors.textContent = this.errors;
                this.resultAccuracy.textContent = `${Math.min(100, Math.round(finalAccuracy))}%`;
                this.resultChars.textContent = this.totalTypedChars;
                
                // Show results section
                this.resultsContainer.classList.add('active');
                
                // Scroll to results
                setTimeout(() => {
                    this.resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 300);
            }
            
            resetPractice() {
                // Reset all state
                clearInterval(this.timerInterval);
                
                this.currentPassageIndex = 0;
                this.errors = 0;
                this.startTime = null;
                this.endTime = null;
                this.isRunning = false;
                this.isCompleted = false;
                this.isPaused = false;
                this.totalTypedChars = 0;
                this.correctChars = 0;
                this.errorMap.clear();
                this.hasStarted = false;
                this.timeLeft = this.totalTime;
                
                // Reset UI
                this.typingInput.value = '';
                this.typingInput.disabled = false;
                this.typingInput.classList.remove('disabled');
                this.typingInput.focus();
                
                this.startButton.style.display = 'flex';
                this.pauseButton.style.display = 'none';
                this.pauseButton.innerHTML = '<i class="fas fa-pause"></i> Pause';
                this.progressPercent.textContent = '0%';
                
                this.resultsContainer.classList.remove('active');
                
                this.updatePassageDisplay();
                this.updateTimerDisplay();
                this.updateStatus();
                
                // Show tab overlay again
                if (this.showTabOverlay) {
                    setTimeout(() => {
                        this.tabStartOverlay.classList.add('active');
                    }, 300);
                }
            }
        }

        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            const typingPractice = new PassageTypingPractice();
            window.typingPractice = typingPractice;
        });
    </script>
</body>
</html>
