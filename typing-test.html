<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Test | TypeNova</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* CSS Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #7c3aed;
            --primary-dark: #5b21b6;
            --primary-light: #a78bfa;
            --secondary: #0ea5e9;
            --dark-bg: #0f172a;
            --dark-card: #1e293b;
            --dark-border: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --accent: #10b981;
            --error: #ef4444;
            --success: #22c55e;
            --warning: #f59e0b;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        h1, h2, h3, h4 {
            font-weight: 700;
            line-height: 1.2;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            cursor: pointer;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .section {
            padding: 60px 0;
        }

        .btn {
            display: inline-block;
            padding: 14px 32px;
            border-radius: var(--radius);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover,
        .btn-primary:focus {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
        }

        .btn-secondary {
            background-color: transparent;
            color: var(--text-primary);
            border: 2px solid var(--dark-border);
        }

        .btn-secondary:hover,
        .btn-secondary:focus {
            border-color: var(--primary);
            background-color: rgba(124, 58, 237, 0.1);
            transform: translateY(-3px);
        }

        /* Header / Navbar */
        header {
            position: sticky;
            top: 0;
            background-color: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            border-bottom: 1px solid var(--dark-border);
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
        }

        .logo-highlight {
            color: var(--primary);
            font-weight: 800;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-link {
            font-weight: 500;
            position: relative;
            padding: 5px 0;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--primary);
            transition: width 0.3s ease;
        }

        .nav-link:hover::after,
        .nav-link:focus::after {
            width: 100%;
        }

        .nav-link:hover,
        .nav-link:focus {
            color: var(--primary-light);
        }

        .nav-cta {
            background-color: var(--primary);
            padding: 10px 24px;
            border-radius: var(--radius);
            transition: var(--transition);
        }

        .nav-cta:hover,
        .nav-cta:focus {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        /* Test Container */
        .test-container {
            max-width: 800px;
            margin: 40px auto;
            padding: 40px;
            background-color: var(--dark-card);
            border-radius: var(--radius);
            border: 1px solid var(--dark-border);
        }

        .test-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .test-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, var(--text-primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .test-header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Test Controls */
        .test-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: rgba(30, 41, 59, 0.7);
            border-radius: var(--radius);
            flex-wrap: wrap;
            gap: 15px;
        }

        .time-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .time-btn {
            padding: 10px 20px;
            background-color: transparent;
            border: 2px solid var(--dark-border);
            color: var(--text-secondary);
            border-radius: var(--radius);
            font-weight: 600;
            transition: var(--transition);
        }

        .time-btn:hover,
        .time-btn:focus {
            border-color: var(--primary);
            color: var(--text-primary);
        }

        .time-btn.active {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .test-stats {
            display: flex;
            gap: 25px;
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-box {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-light);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .test-actions {
            display: flex;
            gap: 15px;
        }

        /* Text Display */
        .text-display-container {
            margin-bottom: 40px;
            position: relative;
        }

        .text-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.4rem;
            line-height: 1.8;
            padding: 30px;
            background-color: rgba(15, 23, 42, 0.8);
            border-radius: var(--radius);
            border: 2px solid var(--dark-border);
            min-height: 200px;
            position: relative;
            overflow: hidden;
        }

        .text-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.3), transparent);
        }

        .text-display::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: linear-gradient(to top, rgba(0,0,0,0.3), transparent);
        }

        .word {
            margin-right: 12px;
            position: relative;
            display: inline-block;
            transition: color 0.2s ease;
        }

        .word.current {
            background-color: rgba(124, 58, 237, 0.2);
            border-radius: 4px;
        }

        .word.correct {
            color: var(--success);
        }

        .word.incorrect {
            color: var(--error);
        }

        .word.extra {
            color: var(--warning);
            text-decoration: line-through;
        }

        .cursor {
            display: inline-block;
            width: 2px;
            height: 1.4em;
            background-color: var(--primary);
            position: absolute;
            animation: blink 1s infinite;
            vertical-align: middle;
            margin-left: -12px;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* Input Area */
        .input-container {
            position: relative;
            margin-bottom: 40px;
        }

        .test-input {
            width: 100%;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.4rem;
            background-color: rgba(15, 23, 42, 0.8);
            border: 2px solid var(--dark-border);
            border-radius: var(--radius);
            color: var(--text-primary);
            resize: none;
            min-height: 120px;
            transition: var(--transition);
        }

        .test-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2);
        }

        .input-placeholder {
            position: absolute;
            top: 20px;
            left: 20px;
            color: var(--text-secondary);
            font-size: 1.4rem;
            pointer-events: none;
            font-family: 'JetBrains Mono', monospace;
        }

        .test-input:focus + .input-placeholder,
        .test-input:not(:placeholder-shown) + .input-placeholder {
            display: none;
        }

        /* Results Panel */
        .results-panel {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.9), rgba(15, 23, 42, 0.95));
            border-radius: var(--radius);
            padding: 40px;
            margin-top: 40px;
            display: none;
            border: 1px solid var(--dark-border);
        }

        .results-panel.active {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .results-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary-light);
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .result-card {
            background-color: var(--dark-bg);
            padding: 25px;
            border-radius: var(--radius);
            text-align: center;
            border: 1px solid var(--dark-border);
            transition: var(--transition);
        }

        .result-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: var(--shadow);
        }

        .result-value {
            font-size: 3rem;
            font-weight: 800;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 10px;
        }

        .result-value.wpm {
            color: var(--success);
        }

        .result-value.accuracy {
            color: var(--accent);
        }

        .result-value.time {
            color: var(--secondary);
        }

        .result-label {
            color: var(--text-secondary);
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .result-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        /* Footer */
        footer {
            background-color: var(--dark-card);
            padding: 60px 0 30px;
            border-top: 1px solid var(--dark-border);
            margin-top: 60px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-about h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
        }

        .footer-about p {
            color: var(--text-secondary);
        }

        .footer-links h4 {
            font-size: 1.2rem;
            margin-bottom: 20px;
        }

        .footer-links ul {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: var(--text-secondary);
            transition: var(--transition);
        }

        .footer-links a:hover,
        .footer-links a:focus {
            color: var(--primary-light);
            padding-left: 5px;
        }

        .social-icons {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }

        .social-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--dark-border);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .social-icon:hover,
        .social-icon:focus {
            background-color: var(--primary);
            transform: translateY(-5px);
        }

        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid var(--dark-border);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .test-container {
                padding: 20px;
                margin: 20px auto;
            }
            
            .test-header h1 {
                font-size: 2rem;
            }
            
            .test-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .time-selector {
                justify-content: center;
            }
            
            .test-stats {
                justify-content: space-around;
            }
            
            .test-actions {
                justify-content: center;
            }
            
            .text-display {
                font-size: 1.2rem;
                padding: 20px;
            }
            
            .test-input {
                font-size: 1.2rem;
            }
            
            .results-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .result-value {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .test-header h1 {
                font-size: 1.5rem;
            }
            
            .time-btn {
                padding: 8px 15px;
                font-size: 0.9rem;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .text-display {
                font-size: 1rem;
            }
            
            .test-input {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header / Navbar -->
    <header>
        <div class="container">
            <nav class="navbar" aria-label="Main Navigation">
                <a href="index.html" class="logo">Type<span class="logo-highlight">Nova</span></a>
                
                <ul class="nav-links" role="menu">
                    <li role="none"><a href="index.html" class="nav-link" role="menuitem">Home</a></li>
                    <li role="none"><a href="test.html" class="nav-link" role="menuitem">Typing Test</a></li>
                    <li role="none"><a href="#" class="nav-link" role="menuitem">Practice</a></li>
                    <li role="none"><a href="#" class="nav-link" role="menuitem">Games</a></li>
                    <li role="none"><a href="#" class="nav-link" role="menuitem">Leaderboard</a></li>
                    <li role="none"><a href="#" class="nav-link nav-cta" role="menuitem">Login / Sign Up</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Test Section -->
    <main>
        <div class="container">
            <div class="test-container">
                <div class="test-header">
                    <h1>Typing Speed Test</h1>
                    <p>Test your typing speed and accuracy. Select a time limit and start typing!</p>
                </div>

                <!-- Test Controls -->
                <div class="test-controls">
                    <div class="time-selector">
                        <button class="time-btn active" data-time="30">30 seconds</button>
                        <button class="time-btn" data-time="60">60 seconds</button>
                        <button class="time-btn" data-time="120">120 seconds</button>
                    </div>
                    
                    <div class="test-stats">
                        <div class="stat-box">
                            <div class="stat-value" id="time-left">30</div>
                            <div class="stat-label">Seconds</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="wpm">0</div>
                            <div class="stat-label">WPM</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="accuracy">100%</div>
                            <div class="stat-label">Accuracy</div>
                        </div>
                    </div>
                    
                    <div class="test-actions">
                        <button class="btn btn-primary" id="start-btn">Start Test</button>
                        <button class="btn btn-secondary" id="reset-btn" disabled>Reset</button>
                    </div>
                </div>

                <!-- Text Display -->
                <div class="text-display-container">
                    <div class="text-display" id="text-display">
                        <!-- Words will be inserted here by JavaScript -->
                        <span class="word">The</span>
                        <span class="word">quick</span>
                        <span class="word">brown</span>
                        <span class="word">fox</span>
                        <span class="word">jumps</span>
                        <span class="word">over</span>
                        <span class="word">the</span>
                        <span class="word">lazy</span>
                        <span class="word">dog</span>
                        <span class="word">while</span>
                        <span class="word">the</span>
                        <span class="word">sun</span>
                        <span class="word">shines</span>
                        <span class="word">brightly</span>
                        <span class="word">in</span>
                        <span class="word">the</span>
                        <span class="word">clear</span>
                        <span class="word">blue</span>
                        <span class="word">sky</span>
                        <span class="word">above</span>
                        <span class="word">the</span>
                        <span class="word">peaceful</span>
                        <span class="word">countryside</span>
                        <span class="word">where</span>
                        <span class="word">birds</span>
                        <span class="word">sing</span>
                        <span class="word">and</span>
                        <span class="word">flowers</span>
                        <span class="word">bloom</span>
                        <span class="word">throughout</span>
                        <span class="word">the</span>
                        <span class="word">season</span>
                        <span class="word">bringing</span>
                        <span class="word">joy</span>
                        <span class="word">to</span>
                        <span class="word">all</span>
                        <span class="word">who</span>
                        <span class="word">witness</span>
                        <span class="word">nature's</span>
                        <span class="word">beauty</span>
                        <span class="word">unfold</span>
                        <span class="word">before</span>
                        <span class="word">their</span>
                        <span class="word">eyes</span>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="input-container">
                    <textarea 
                        class="test-input" 
                        id="typing-input" 
                        placeholder=" "
                        rows="4"
                        disabled
                    ></textarea>
                    <div class="input-placeholder">Start typing here when the test begins...</div>
                </div>

                <!-- Results Panel -->
                <div class="results-panel" id="results-panel">
                    <div class="results-header">
                        <h2>Test Complete!</h2>
                        <p>Here are your typing test results:</p>
                    </div>
                    
                    <div class="results-grid">
                        <div class="result-card">
                            <div class="result-value wpm" id="result-wpm">0</div>
                            <div class="result-label">Words Per Minute</div>
                        </div>
                        <div class="result-card">
                            <div class="result-value accuracy" id="result-accuracy">100%</div>
                            <div class="result-label">Accuracy</div>
                        </div>
                        <div class="result-card">
                            <div class="result-value time" id="result-time">0s</div>
                            <div class="result-label">Time Taken</div>
                        </div>
                        <div class="result-card">
                            <div class="result-value" id="result-errors">0</div>
                            <div class="result-label">Errors</div>
                        </div>
                    </div>
                    
                    <div class="result-actions">
                        <button class="btn btn-primary" id="retry-btn">Try Again</button>
                        <button class="btn btn-secondary" id="practice-btn">Practice Mode</button>
                        <button class="btn btn-secondary" id="share-btn">Share Results</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-about">
                    <h3>Type<span style="color: var(--primary);">Nova</span></h3>
                    <p>TypeNova is your ultimate platform for improving typing speed and accuracy. Join our community and master your keyboard skills through tests, practice, and fun games.</p>
                    <div class="social-icons">
                        <a href="#" class="social-icon" aria-label="Follow us on Twitter">ùïè</a>
                        <a href="#" class="social-icon" aria-label="Follow us on Facebook">ùîΩ</a>
                        <a href="#" class="social-icon" aria-label="Follow us on Instagram">ùïÄ</a>
                        <a href="#" class="social-icon" aria-label="Subscribe on YouTube">ùïê</a>
                    </div>
                </div>
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="test.html">Typing Test</a></li>
                        <li><a href="#">Practice</a></li>
                        <li><a href="#">Games</a></li>
                        <li><a href="#">Leaderboard</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="#">Typing Tips</a></li>
                        <li><a href="#">Practice Guides</a></li>
                        <li><a href="#">WPM Standards</a></li>
                        <li><a href="#">Keyboard Layouts</a></li>
                        <li><a href="#">Blog</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                &copy; <span id="current-year">2023</span> TypeNova. All rights reserved. | Boost Your Speed. Master Your Keys.
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const textDisplay = document.getElementById('text-display');
            const typingInput = document.getElementById('typing-input');
            const timeLeft = document.getElementById('time-left');
            const wpmDisplay = document.getElementById('wpm');
            const accuracyDisplay = document.getElementById('accuracy');
            const startBtn = document.getElementById('start-btn');
            const resetBtn = document.getElementById('reset-btn');
            const timeButtons = document.querySelectorAll('.time-btn');
            const resultsPanel = document.getElementById('results-panel');
            const resultWPM = document.getElementById('result-wpm');
            const resultAccuracy = document.getElementById('result-accuracy');
            const resultTime = document.getElementById('result-time');
            const resultErrors = document.getElementById('result-errors');
            const retryBtn = document.getElementById('retry-btn');
            const practiceBtn = document.getElementById('practice-btn');
            const shareBtn = document.getElementById('share-btn');
            
            // Test state
            let testActive = false;
            let timeLimit = 30;
            let timeRemaining = timeLimit;
            let timerInterval = null;
            let startTime = null;
            let endTime = null;
            let currentWordIndex = 0;
            let correctChars = 0;
            let totalChars = 0;
            let errors = 0;
            let words = [];
            
            // Sample texts for typing test
            const sampleTexts = [
                "The quick brown fox jumps over the lazy dog while the sun shines brightly in the clear blue sky above the peaceful countryside where birds sing and flowers bloom throughout the season bringing joy to all who witness nature's beauty unfold before their eyes",
                "Programming is the process of creating a set of instructions that tell a computer how to perform a task. It involves writing code in various languages like JavaScript, Python, and Java to solve problems and build applications that make our lives easier and more efficient in this digital age",
                "Success is not final, failure is not fatal: it is the courage to continue that counts. Every great achievement was once considered impossible until someone decided to try. The only way to do great work is to love what you do and believe in your ability to make a difference",
                "Technology continues to evolve at an astonishing pace, transforming how we communicate, work, and live. From artificial intelligence to quantum computing, innovations are reshaping our world and creating new opportunities for those willing to learn and adapt to constant change",
                "The beauty of nature lies in its diversity and resilience. Forests, oceans, mountains, and deserts all contain unique ecosystems that support life in extraordinary ways. Protecting our environment is essential for future generations to enjoy the wonders of our planet"
            ];
            
            // Initialize
            loadNewText();
            updateCopyrightYear();
            
            // Event Listeners
            startBtn.addEventListener('click', startTest);
            resetBtn.addEventListener('click', resetTest);
            typingInput.addEventListener('input', handleTyping);
            typingInput.addEventListener('keydown', handleKeyDown);
            
            timeButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    if (testActive) return;
                    
                    timeButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    timeLimit = parseInt(this.dataset.time);
                    timeRemaining = timeLimit;
                    timeLeft.textContent = timeRemaining;
                    resetTest();
                });
            });
            
            retryBtn.addEventListener('click', function() {
                resetTest();
                startTest();
            });
            
            practiceBtn.addEventListener('click', function() {
                alert('Practice mode coming soon!');
            });
            
            shareBtn.addEventListener('click', function() {
                const wpm = resultWPM.textContent;
                const accuracy = resultAccuracy.textContent;
                const text = `I just typed at ${wpm} WPM with ${accuracy} accuracy on TypeNova! Try it yourself.`;
                
                if (navigator.share) {
                    navigator.share({
                        title: 'My Typing Test Results',
                        text: text,
                        url: window.location.href
                    });
                } else {
                    // Fallback for browsers that don't support Web Share API
                    navigator.clipboard.writeText(text)
                        .then(() => alert('Results copied to clipboard!'))
                        .catch(() => alert(text));
                }
            });
            
            // Functions
            function loadNewText() {
                const randomIndex = Math.floor(Math.random() * sampleTexts.length);
                const text = sampleTexts[randomIndex];
                words = text.split(' ');
                
                // Clear and populate text display
                textDisplay.innerHTML = '';
                words.forEach((word, index) => {
                    const span = document.createElement('span');
                    span.className = 'word';
                    span.textContent = word + ' ';
                    span.dataset.index = index;
                    textDisplay.appendChild(span);
                });
                
                // Reset cursor position
                currentWordIndex = 0;
                updateCursor();
                
                // Reset stats
                correctChars = 0;
                totalChars = 0;
                errors = 0;
                updateStats();
            }
            
            function startTest() {
                if (testActive) return;
                
                testActive = true;
                startTime = new Date();
                timeRemaining = timeLimit;
                
                // Enable input
                typingInput.disabled = false;
                typingInput.focus();
                
                // Update buttons
                startBtn.disabled = true;
                startBtn.textContent = 'Testing...';
                resetBtn.disabled = false;
                
                // Start timer
                timerInterval = setInterval(updateTimer, 1000);
                
                // Disable time selection during test
                timeButtons.forEach(btn => btn.style.pointerEvents = 'none');
            }
            
            function resetTest() {
                testActive = false;
                
                // Clear timer
                clearInterval(timerInterval);
                
                // Reset time
                timeRemaining = timeLimit;
                timeLeft.textContent = timeRemaining;
                
                // Reset input
                typingInput.value = '';
                typingInput.disabled = true;
                
                // Reset buttons
                startBtn.disabled = false;
                startBtn.textContent = 'Start Test';
                resetBtn.disabled = true;
                
                // Reset words highlighting
                document.querySelectorAll('.word').forEach(word => {
                    word.className = 'word';
                });
                
                // Hide results
                resultsPanel.classList.remove('active');
                
                // Load new text
                loadNewText();
                
                // Enable time selection
                timeButtons.forEach(btn => btn.style.pointerEvents = 'auto');
            }
            
            function updateTimer() {
                timeRemaining--;
                timeLeft.textContent = timeRemaining;
                
                if (timeRemaining <= 0) {
                    endTest();
                }
            }
            
            function endTest() {
                testActive = false;
                endTime = new Date();
                
                // Clear timer
                clearInterval(timerInterval);
                
                // Disable input
                typingInput.disabled = true;
                
                // Calculate results
                const timeTaken = timeLimit;
                const wpm = calculateWPM();
                const accuracy = calculateAccuracy();
                
                // Update results display
                resultWPM.textContent = wpm;
                resultAccuracy.textContent = accuracy + '%';
                resultTime.textContent = timeTaken + 's';
                resultErrors.textContent = errors;
                
                // Show results panel
                resultsPanel.classList.add('active');
                
                // Update buttons
                startBtn.disabled = false;
                startBtn.textContent = 'Start Test';
                resetBtn.disabled = true;
                
                // Enable time selection
                timeButtons.forEach(btn => btn.style.pointerEvents = 'auto');
            }
            
            function handleTyping(e) {
                if (!testActive) return;
                
                const input = typingInput.value;
                const wordsArray = input.split(' ');
                const currentWord = wordsArray[currentWordIndex] || '';
                
                // Update word highlighting
                document.querySelectorAll('.word').forEach((wordEl, index) => {
                    const word = words[index];
                    const userWord = wordsArray[index] || '';
                    
                    wordEl.className = 'word';
                    
                    if (index < currentWordIndex) {
                        // Past words
                        if (userWord === word) {
                            wordEl.classList.add('correct');
                        } else {
                            wordEl.classList.add('incorrect');
                        }
                    } else if (index === currentWordIndex) {
                        // Current word
                        wordEl.classList.add('current');
                        
                        // Check each character
                        const wordChars = word.split('');
                        const userChars = userWord.split('');
                        
                        for (let i = 0; i < Math.max(wordChars.length, userChars.length); i++) {
                            if (i >= userChars.length) break;
                            
                            if (userChars[i] === wordChars[i]) {
                                correctChars++;
                            } else {
                                errors++;
                            }
                            totalChars++;
                        }
                        
                        // Handle extra characters
                        if (userChars.length > wordChars.length) {
                            errors += (userChars.length - wordChars.length);
                            wordEl.classList.add('extra');
                        }
                    }
                });
                
                // Move to next word if space is pressed and we have content
                if (input.endsWith(' ') && currentWord.trim() !== '') {
                    currentWordIndex++;
                    updateCursor();
                    
                    // Scroll to keep current word in view
                    const currentWordEl = document.querySelector(`.word[data-index="${currentWordIndex}"]`);
                    if (currentWordEl) {
                        currentWordEl.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });
                    }
                }
                
                updateStats();
            }
            
            function handleKeyDown(e) {
                // Prevent space from being entered at the beginning
                if (e.key === ' ' && typingInput.value.trim() === '') {
                    e.preventDefault();
                }
                
                // Backspace handling for word navigation
                if (e.key === 'Backspace' && typingInput.value.endsWith(' ') && currentWordIndex > 0) {
                    e.preventDefault();
                    currentWordIndex--;
                    updateCursor();
                    
                    // Remove the last word from input
                    const wordsArray = typingInput.value.trim().split(' ');
                    wordsArray.pop();
                    typingInput.value = wordsArray.join(' ') + ' ';
                }
            }
            
            function updateCursor() {
                // Remove existing cursor
                document.querySelectorAll('.cursor').forEach(c => c.remove());
                
                // Add cursor to current word
                const currentWordEl = document.querySelector(`.word[data-index="${currentWordIndex}"]`);
                if (currentWordEl) {
                    const cursor = document.createElement('span');
                    cursor.className = 'cursor';
                    currentWordEl.appendChild(cursor);
                }
            }
            
            function updateStats() {
                if (!testActive) return;
                
                // Calculate WPM
                const wpm = calculateWPM();
                wpmDisplay.textContent = wpm;
                
                // Calculate accuracy
                const accuracy = calculateAccuracy();
                accuracyDisplay.textContent = accuracy + '%';
            }
            
            function calculateWPM() {
                if (!startTime || totalChars === 0) return 0;
                
                const timeElapsed = (timeLimit - timeRemaining) || 1;
                const wordsTyped = correctChars / 5; // Standard: 5 characters = 1 word
                const wpm = Math.round((wordsTyped / timeElapsed) * 60);
                return wpm > 0 ? wpm : 0;
            }
            
            function calculateAccuracy() {
                if (totalChars === 0) return 100;
                
                const accuracy = Math.round(((totalChars - errors) / totalChars) * 100);
                return accuracy > 0 ? accuracy : 0;
            }
            
            function updateCopyrightYear() {
                const yearSpan = document.getElementById('current-year');
                if (yearSpan) {
                    yearSpan.textContent = new Date().getFullYear();
                }
            }
            
            // Initialize cursor position
            updateCursor();
        });
    </script>
</body>
</html>
